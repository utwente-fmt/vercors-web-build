
<!DOCTYPE HTML>
<!--
VerCors Tool --- Formal Methods and Tools Group (EWI)
University of Twente, Enschede, The Netherlands
-->
<html lang="en">
    <head>
        <title>No-send-after-read Â· VerCors Tool FMT | UTwente </title>
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta http-equiv="content-type" content="text/html; charset=utf-8">
        <meta name="description" content="">
        <meta name="keywords" content="">

        <link rel="stylesheet" href="/css/codemirror.css">
        <link rel="stylesheet" href="/css/codemirror-monokai.css">
        <link rel="stylesheet" href="/css/highlight/default.css">
        <link rel="stylesheet" href="/css/datatables.min.css">
        <link rel="stylesheet" href="/css/style.css">

        <script src="/js/jquery.min.js"></script>
        <script src="/js/highlight.pack.js"></script>
        <script src="/js/codemirror.js"></script>
        <script src="/js/datatables.min.js"></script>
        <script src="/js/vercorsonline.js"></script>
        <script src="/js/init.js"></script>

        <!--<script type="text/javascript">
            hljs.initHighlightingOnLoad();
        </script>-->
    </head>
    <body class="no-sidebar">
        <div id="header">
            <h1 id="logo" style="position: relative">
                <span id="hamburger" onclick="document.querySelector('#nav').classList.toggle('open')" class="fa fa-bars"></span>
                <a href="/">The VerCors Verifier</a>
            </h1>
            <nav id="nav">
                <ul>
                    <li>
                        <a href="/wiki/#introduction">Getting Started</a>
                        <ul>
                            <li><a href="/wiki/#introduction">Introduction</a></li>
                            <li><a href="/wiki/#installing-and-running-vercors">Installation Guide</a></li>
                            <li><a href="/wiki/">Tutorial</a></li>
                            <li>
                                <a href="//github.com/utwente-fmt/vercors/issues" target="_blank">
                                    Issue Tracker
                                    <span class="fa fa-external-link" style="font-size: 10pt"></span>
                                </a>
                            </li>
                        </ul>
                    </li>
                    <li><a href="/try_online/examples/">Showcases</a></li>
                    <li><a href="/news/">News</a></li>
                    <li><a href="/publications/">Publications</a></li>
                    <li>
                        <a href="/about/">About</a>
                        <ul>
                            <li><a href="/about/#Team">VerCors Team</a></li>
                            <li><a href="/about/#Contact">Contact</a></li>
                            <li><a href="/about/#Credits">Credits</a></li>
                            <li><a href="/license/">License</a></li>
                        </ul>
                    </li>
                </ul>
            </nav>
            <div class="container">
                <div id="banner">
                    <div class="container">
                        <section>
                            
                            <p>
                                <a href="//github.com/utwente-fmt/vercors" class="button alt" target="_blank">
                                    View on Github
                                </a>
                                <a href="/try_online/" class="button alt">Try VerCors Online</a>
                            </p>
                        </section>
                    </div>
                </div>
            </div>
        </div>

        
<div id="main" class="style1 wrapper">
    <div class="container">
        
    <div class="example-view">
        <h1>No-send-after-read</h1>
        <p>This verification example covers a common security property: a secure device does not send out data when it received privacy-sensitive information. Model-based abstraction is used to verify that the program adheres to a process algebra abstraction, which does not perform a &#39;send&#39; action after receiving privacy-sensitive information.</p>

        <h3>General Information</h3>
        <ul>
            <li><strong>Backend</strong>: Silicon</li>
            <li><strong>Language</strong>: Java</li>
            <li><strong>Features</strong>: Futures</li>
            <li><strong>Path to Example File</strong>: futures/NoSendAfterRead.java</li>
            <li><strong>Should Verify</strong>: Yes</li>
            <li><strong>Date</strong>: 2017-06-16</li>
            <li><strong>Lines of Code</strong>: 127 (comments not included)</li>
            <li><strong>Lines of Specification</strong>: 66 (52.0% of total)</li>
            
                <li><strong>Computation Time</strong>: 25.3 seconds</li>
            
        </ul>

        
<div class="verification-container">
    
    <div class="verification-widget verification-non-plain" >
        <div style="position: relative">
            <textarea name="examplecode" rows="20" data-code-mirror="true">// -*- tab-width:2 ; indent-tabs-mode:nil -*-
//:: case NoSendAfterRead
//:: suite puptol
//:: tool silicon
//:: option --check-history

public class Future {/*@
  ghost boolean flag;
  
  accessible flag; //skip(all)
  requires flag;
  process p_send();
  
  accessible flag; //skip(all)
  requires !flag;  //skip(all)
  process receive();

  modifies flag;  //skip(all)
  ensures !flag;
  process clear();
  
  requires true; //skip(all)
  ensures true;  //skip(all)
  process nsar()=p_send()*nsar()+clear()*rs();
  
  process rs()=clear()*rs()+receive()*rs();

@*/}

class Device {
  Future F;

/*@
  ensures Value(F) ** HPerm(F.flag,1) ** F.flag;
  ensures Future(F,1,F.nsar());
@*/
  public Device() {
    /*@ghost {
      F = new `Future`();
      F.flag = true;
      create F, F.nsar();
    }@*/
  }

/*@
  given frac p; //skip(all)
  given process P; //skip(all)
  requires p!=none ** Value(F); //skip(all)
  requires HPerm(F.flag,p) ** F.flag ** Future(F,p,F.p_send()*P);
  ensures  p!=none ** Value(F); //skip(all)
  ensures HPerm(F.flag,p) ** F.flag ** Future(F,p,P);
@*/
  void send();

/*@ 
  given frac p; //skip(all)
  given process P; //skip(all)
  requires p!=none ** Value(F) ** HPerm(F.flag,p)//skip(all)
    ** !F.flag; //skip(all)
  requires Future(F,p,F.receive()*P); 
  ensures  p!=none ** Value(F) ** HPerm(F.flag,p) ** !F.flag; //skip(all)
  ensures Future(F,p,P);
@*/
  void receive();
}

class Lock {
  //@ ghost Device d;
  
  boolean flag;
  
  /*@ inline resource inv()=
        Value(d)**Perm(flag,write)**Value(d.F)**
        HPerm(d.F.flag,write)**d.F.flag==flag; @*/
  
  //@ ensures inv();
  void lock();
  
  //@ requires inv();
  void unlock();

}

class Sender {
  Device d;

  Lock l;

/*@  
     requires Value(d) ** Value(d.F); //skip(run)
     requires Future(d.F,1\2,d.F.nsar()); 
  requires Value(l) ** Value(l.d) ** l.d==d; //skip(run)
@*/ public void run(){
/*@ loop_invariant Value(d) ** Value(d.F) ** Value(l)//skip(run)
    ** Value(l.d) ** l.d==d; //skip(run)
    loop_invariant Future(d.F,1\2,d.F.nsar());
@*/ while(true){
      l.lock();
      if (l.flag){
        //@ choose d.F,1\2,d.F.nsar(),d.F.p_send()*d.F.nsar(); //skip(run)
        d.send()
            /*@ with { p=1\2; P=d.F.nsar();} @*/; //skip(run)
      }
      l.unlock();
    }
  }
}

class Reader {
  Device d;

  Lock l;
/*@ requires Value(d) ** Value(l) ** Value(l.d) ** //skip(run)
     l.d==d ** Value(d.F); //skip(run)
    requires Future(d.F,1\2,d.F.rs());
@*/ public void run(){
/*@ loop_invariant Value(d) ** Value(d.F) ** Value(l) ** //skip(run)
      Value(l.d) ** l.d==d; // skip(run)  
    loop_invariant Future(d.F,1\2,d.F.rs()); @*/
    while(true){
      l.lock();
      //@ choose d.F,1\2,d.F.rs(),d.F.clear()*d.F.rs(); //skip(run)
      { //@ action d.F,1\2,d.F.rs(),d.F.clear();
        l.flag=false;
        //@ ghost d.F.flag=false;
      }
      //@ choose d.F,1\2,d.F.rs(),d.F.receive()*d.F.rs(); //skip(run)
      d.receive()
          /*@ with { p=1\2; P=d.F.rs();} @*/; //skip(run)
      l.unlock();
    }
  }
}

</textarea>
            <span class="code-buttons">
                <span class="fa fa-times-circle code-close-button"></span>
                <span class="fa fa-play code-run-button"></span>
            </span>
        </div>

        <div style="background-color: #dddddd; padding: 0.4ex 1ex">
            <label class="control-label" for="example-backendid">Language:</label>
            <select name="lang" id="example-backendid" class="form-control">
                
                    <option value="pvl" selected="">PVL</option>
                
                    <option value="java" >Java</option>
                
                    <option value="cu" >Cuda</option>
                
                    <option value="c" >C / OpenMP / OpenCL</option>
                
                    <option value="sil" >Viper</option>
                
            </select>
        </div>
    </div>
    <div class="verification-progress verification-non-plain" style="display: none; background-color: #dddddd; padding: 0.4ex 1ex" >
        <span class="fa"></span>
        <span class="verification-progress-text"></span>
    </div>
    <pre class="verification-log verification-non-plain" style="display: none"></pre>
</div>

    </div>

    </div>
</div>


        <div id="footer">
            <div class="row">
                <a href="//fmt.ewi.utwente.nl" target="_blank"><img src="/images/FMT logo.png" alt=""></a>
                <div class="copyright">
                    <a href="//fmt.ewi.utwente.nl/research/projects/view/vercors/" target="_blank">Copyright <code>&copy</code> The VerCors Project 2007-2022</a>
                    | <a href="//fmt.ewi.utwente.nl" target="_blank">FMT - University of Twente</a>
                    | <a href="/about/">About Us</a>
                </div>
            </div>
        </div>
    </body>
</html>