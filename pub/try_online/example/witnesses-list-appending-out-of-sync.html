
<!DOCTYPE HTML>
<!--
VerCors Tool --- Formal Methods and Tools Group (EWI)
University of Twente, Enschede, The Netherlands
-->
<html lang="en">
    <head>
        <title>Witnesses: List appending (out-of-sync) Â· VerCors Tool FMT | UTwente </title>
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta http-equiv="content-type" content="text/html; charset=utf-8">
        <meta name="description" content="">
        <meta name="keywords" content="">

        <link rel="stylesheet" href="/css/external/codemirror.css">
        <link rel="stylesheet" href="/css/external/codemirror-monokai.css">
        <link rel="stylesheet" href="/css/highlight/default.css">
        <link rel="stylesheet" href="/css/external/datatables.min.css">
        <link rel="stylesheet" href="/css/global.css">
        <link rel="stylesheet" href="/css/elements.css">
        <link rel="stylesheet" href="/css/colors.css">
        <link rel="stylesheet" href="/css/shared.css">
        <link rel="stylesheet" href="/css/datatables.css">
        <link rel="stylesheet" href="/css/home.css">
        <link rel="stylesheet" href="/css/online.css">
        <link rel="stylesheet" href="/css/credits.css">
        <link rel="stylesheet" href="/css/wiki.css">
        <link rel="stylesheet" href="/css/responsive.css">

        <script src="/js/jquery.min.js"></script>
        <script src="/js/highlight.pack.js"></script>
        <script src="/js/codemirror.js"></script>
        <script src="/js/datatables.min.js"></script>
        <script src="/js/vercorsonline.js"></script>
        <script src="/js/init.js"></script>

        <!--<script type="text/javascript">
            hljs.initHighlightingOnLoad();
        </script>-->
    </head>
    <body class="no-sidebar">
        <div id="header" class="">
            <nav>
                <div class="container">
                    <div id="logo">
                        <span id="hamburger" onclick="document.querySelector('nav').classList.toggle('open')"><span class="fa fa-bars"></span></span><!--
                        --><a href="/"><img id="logo-light" src="/images/logo.svg" title="The VerCors Verifier" alt="Logo of the VerCors Verifier"><img id="logo-dark" src="/images/logo-white.svg" title="The VerCors Verifier" alt="Logo of the VerCors Verifier"></a>
                    </div>
                    <ul>
                        <li>
                            <a href="/wiki/#introduction">Getting Started</a>
                            <ul>
                                <li><a href="/wiki/#installing-and-running-vercors">Installation Guide</a></li>
                                <li><a href="/wiki/">Tutorial</a></li>
                                <li>
                                    <a href="//github.com/utwente-fmt/vercors/issues" target="_blank">
                                        Issue Tracker
                                        <span class="fa fa-external-link" style="font-size: 10pt"></span>
                                    </a>
                                </li>
                            </ul>
                        </li>
                        <li><a href="/try_online/examples/">Showcases</a></li>
                        <li><a href="/news/">News</a></li>
                        <li><a href="/publications/">Publications</a></li>
                        <li>
                            <a href="/about/">About</a>
                            <ul>
                                <li><a href="/about/#Team">VerCors Team</a></li>
                                <li><a href="/about/#Contact">Contact</a></li>
                                <li><a href="/about/#Credits">Credits</a></li>
                                <li><a href="/license/">License</a></li>
                            </ul>
                        </li>
                    </ul>
                </div>
            </nav>
            <div id="banner" class="container">
                <section>
                    
                    <p class="button-row">
                        <a href="//github.com/utwente-fmt/vercors" class="button" target="_blank">
                            View on Github
                        </a>
                        <a href="/try_online/" class="button">Try VerCors Online</a>
                    </p>
                </section>
            </div>
        </div>

        
<div class="alt">
    <section class="container">
        
    <div class="example-view">
        <h1>Witnesses: List appending (out-of-sync)</h1>
        <p>In this version, the structuring of the definitions leads to many (un)fold annotations. This is because the recursion used for state and list is one step out of sync. In the inline version this is solved by inlining list and in ListAppend it is solved by using a single list predicate.</p>

        <h3>General Information</h3>
        <ul>
            <li><strong>Backend</strong>: Silicon</li>
            <li><strong>Language</strong>: Java</li>
            <li><strong>Features</strong>: Sequences, Lists</li>
            <li><strong>Path to Example File</strong>: witnesses/ListAppendASyncDef.java</li>
            <li><strong>Should Verify</strong>: Yes</li>
            <li><strong>Date</strong>: 2017-06-21</li>
            <li><strong>Lines of Code</strong>: 50 (comments not included)</li>
            <li><strong>Lines of Specification</strong>: 31 (62.0% of total)</li>
            
                <li><strong>Computation Time</strong>: 13.8 seconds</li>
            
        </ul>

        
<div class="verification-container">
    
    <div class="verification-widget verification-non-plain" >
        <div style="position: relative">
            <textarea name="examplecode" rows="20" data-code-mirror="true">// -*- tab-width:2 ; indent-tabs-mode:nil -*-
//:: cases ListAppendASyncDef
//:: tools silicon
//:: verdict Pass


/**
  In this version, the structuring of the definitions leads to many
  (un)fold annotations. This is because the recursion used for state
  and list is one step out of sync. In the inline version this is solved
  by inlining list and in ListAppend it is solved by using a single list
  predicate.
*/

final class List {

  public int val;
  public List next;
  
  /*@
    public final resource state()=
      Perm(val,1)**Perm(next,1)**next-&gt;state();

    requires state();
    public pure seq&lt;int&gt; contents()=\unfolding state() \in
        ((next==null)?(seq&lt;int&gt;{val})
                    :(seq&lt;int&gt;{val}+next.contents()));

    public final resource list(seq&lt;int&gt; c)=state() ** contents()==c;
  @*/

  /*@
    ensures list(seq&lt;int&gt;{v});
  @*/
  public List(int v){
    val=v;
    next=null;
    //@ fold state();
    //@ fold list(seq&lt;int&gt;{v});
  }

  /*@
    given    seq&lt;int&gt; L1;
    given    seq&lt;int&gt; L2;
    requires this.list(L1);
    requires l!=null ** l.list(L2);
    ensures  this.list(L1+L2);
  @*/
  public void append_rec(List l){
    //@ unfold list(L1);
    //@ unfold state();
    if (next==null) {
        next=l;
        //@ unfold next.list(L2);
    } else {
        //@ ghost seq&lt;int&gt; tmp = next.contents();
        //@ fold next.list(tmp);
        next.append_rec(l) /*@ with { L1 = tmp ; L2 = L2 ; } @*/;
        //@ unfold next.list(tmp+L2);
    }
    //@ fold state();
    //@ fold list(L1+L2);
  }

}

</textarea>
            <span class="code-buttons">
                <span class="fa fa-times-circle code-close-button"></span>
                <span class="fa fa-play code-run-button"></span>
            </span>
        </div>

        <div style="background-color: #dddddd; padding: 0.4ex 1ex">
            <label class="control-label" for="example-backendid">Language:</label>
            <select name="lang" id="example-backendid" class="form-control">
                
                    <option value="pvl" selected="">PVL</option>
                
                    <option value="java" >Java</option>
                
                    <option value="cu" >Cuda</option>
                
                    <option value="c" >C / OpenMP / OpenCL</option>
                
                    <option value="sil" >Viper</option>
                
            </select>
        </div>
    </div>
    <div class="verification-progress verification-non-plain" style="display: none; background-color: #dddddd; padding: 0.4ex 1ex" >
        <span class="fa"></span>
        <span class="verification-progress-text"></span>
    </div>
    <pre class="verification-log verification-non-plain" style="display: none"></pre>
</div>

    </div>

    </section>
</div>


        <div id="footer" class="dark">
            <footer class="container">
                <a href="//fmt.ewi.utwente.nl" target="_blank"><img src="/images/FMT logo.png" alt=""></a>
                <hr>
                <div class="copyright">
                    <a href="//fmt.ewi.utwente.nl/research/projects/view/vercors/" target="_blank">Copyright <code>&copy</code> The VerCors Project 2007-2023</a>
                    | <a href="//fmt.ewi.utwente.nl" target="_blank">FMT - University of Twente</a>
                    | <a href="/about/">About Us</a>
                </div>
            </footer>
        </div>
    </body>
</html>